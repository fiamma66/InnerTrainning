
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Python 的基礎 - Package 的使用與安裝 1 &#8212; NetPro Python Inner Training</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python 的基礎 - Package 的使用與安裝 2" href="Basic4-5.html" />
    <link rel="prev" title="Python 的基礎 - 檔案操作" href="Basic3.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">NetPro Python Inner Training</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Netpro Python PS 內訓
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  PART1
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="PART1.html">
   第一部分 ： Python 的 基礎
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="Basic.html">
     Python 的安裝
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Basic2.html">
     Python 的基礎 - 語法
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Basic3.html">
     Python 的基礎 - 檔案操作
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Python 的基礎 - Package 的使用與安裝 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Basic4-5.html">
     Python 的基礎 - Package 的使用與安裝 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Basic5.html">
     Python Lab 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Basic6.html">
     Python Lab 2
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  PART2
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../PartII/PART2.html">
   第二部分 ： Python 的 實際應用 小程式
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/PartI/Basic4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/PartI/Basic4.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/fiamma66/InnerTrainning"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/fiamma66/InnerTrainning/master?urlpath=tree/PartI/Basic4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#package-module">
   首先介紹 Package / Module 的使用
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import">
     Import 裡面的小彩蛋
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#package">
   安裝額外 Package
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     安裝後測試
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#psycopg2">
   psycopg2 基礎使用
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="python-package-1">
<h1>Python 的基礎 - Package 的使用與安裝 1<a class="headerlink" href="#python-package-1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="package-module">
<h2>首先介紹 Package / Module 的使用<a class="headerlink" href="#package-module" title="Permalink to this headline">¶</a></h2>
<p>要使用別人寫好的 Package / Module</p>
<p>就是直接</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PACKAGE_NAME</span> <span class="o">/</span> <span class="n">MODULE_NAME</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Python 的 import 有個很基本的準則，<code class="docutils literal notranslate"><span class="pre">『只要用到別的.py</span> <span class="pre">檔案，就一定要引述他』</span></code></p>
<p>只要不同檔案就要『引述』</p>
<p>並沒有像 java 的 class 那樣『同一個資料夾下』或『同一層』</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">這邊不深究 import 與 Package / Module 間的關係</p>
<p>如果有興趣</p>
<p>可以直接參考</p>
<p><a class="reference external" href="https://medium.com/pyladies-taiwan/python-%E7%9A%84-import-%E9%99%B7%E9%98%B1-3538e74f57e3">幾篇文章</a></p>
</div>
<p>最常用到的 比如 <code class="docutils literal notranslate"><span class="pre">os</span></code>  、  <code class="docutils literal notranslate"><span class="pre">sys</span></code>  、  <code class="docutils literal notranslate"><span class="pre">math</span></code>  等等</p>
<p>就拿 math 來做範例</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
<p>之後我們就能夠使用 <code class="docutils literal notranslate"><span class="pre">math</span></code> 中的好用 function</p>
<p>比如 取進位值的 <a class="reference external" href="https://www.w3schools.com/python/ref_math_ceil.asp">math.ceil</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-output tag_show-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">1.4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">5.3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="mf">5.3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">22.6</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">10.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
6
-5
23
10
</pre></div>
</div>
</div>
</div>
<div class="section" id="import">
<h3>Import 裡面的小彩蛋<a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h3>
<p>如果對於 import 的 .py 檔案在哪裡有疑問的話</p>
<p>可以先這樣做</p>
<div class="cell tag_hide-output tag_show-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>


<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/fiammahsu/Workplace/Resource/T_Python(各開發測試)/InnerTrainning/PartI
/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python39.zip
/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9
/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/lib-dynload

/usr/local/lib/python3.9/site-packages
/usr/local/opt/python-tk@3.9/libexec
/usr/local/lib/python3.9/site-packages/IPython/extensions
/Users/fiammahsu/.ipython
</pre></div>
</div>
</div>
</div>
<p>除了 IPython 是 Jupyter 專用的東西以外</p>
<p>其他的路徑就是 python 尋找那些額外安裝的 Package 的路徑</p>
<p>在其中會有一隻  <code class="docutils literal notranslate"><span class="pre">this.py</span></code>  的檔案，就是小彩蛋</p>
<p>可以打開來看一下，如果你拿不到（我們的 NoteBook Server 有相關權限）</p>
<p>可以直接看下面</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Gur Mra bs Clguba, ol Gvz Crgref</span>

<span class="s2">Ornhgvshy vf orggre guna htyl.</span>
<span class="s2">Rkcyvpvg vf orggre guna vzcyvpvg.</span>
<span class="s2">Fvzcyr vf orggre guna pbzcyrk.</span>
<span class="s2">Pbzcyrk vf orggre guna pbzcyvpngrq.</span>
<span class="s2">Syng vf orggre guna arfgrq.</span>
<span class="s2">Fcnefr vf orggre guna qrafr.</span>
<span class="s2">Ernqnovyvgl pbhagf.</span>
<span class="s2">Fcrpvny pnfrf nera&#39;g fcrpvny rabhtu gb oernx gur ehyrf.</span>
<span class="s2">Nygubhtu cenpgvpnyvgl orngf chevgl.</span>
<span class="s2">Reebef fubhyq arire cnff fvyragyl.</span>
<span class="s2">Hayrff rkcyvpvgyl fvyraprq.</span>
<span class="s2">Va gur snpr bs nzovthvgl, ershfr gur grzcgngvba gb thrff.</span>
<span class="s2">Gurer fubhyq or bar-- naq cersrenoyl bayl bar --boivbhf jnl gb qb vg.</span>
<span class="s2">Nygubhtu gung jnl znl abg or boivbhf ng svefg hayrff lbh&#39;er Qhgpu.</span>
<span class="s2">Abj vf orggre guna arire.</span>
<span class="s2">Nygubhtu arire vf bsgra orggre guna *evtug* abj.</span>
<span class="s2">Vs gur vzcyrzragngvba vf uneq gb rkcynva, vg&#39;f n onq vqrn.</span>
<span class="s2">Vs gur vzcyrzragngvba vf rnfl gb rkcynva, vg znl or n tbbq vqrn.</span>
<span class="s2">Anzrfcnprf ner bar ubaxvat terng vqrn -- yrg&#39;f qb zber bs gubfr!&quot;&quot;&quot;</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">97</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
        <span class="n">d</span><span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">c</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">13</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren&#39;t special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you&#39;re Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it&#39;s a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let&#39;s do more of those!
</pre></div>
</div>
</div>
</div>
<p>接著我們試試看 import this</p>
<p>會發現他幫你印出了一個叫做 The Zen Of Python 的文章，大致的主題是整個 Python 語言的良好寫作方式</p>
<p>你應該會好奇，為什麼只是 import 會打出這些文章</p>
<p><font size=5><strong>實際上 import 做的事情，是幫你執行該.py檔案</strong></font></p>
<p>所以 <code class="docutils literal notranslate"><span class="pre">this.py</span></code> 裡最下面的那些會被執行</p>
</div>
</div>
<div class="section" id="package">
<h2>安裝額外 Package<a class="headerlink" href="#package" title="Permalink to this headline">¶</a></h2>
<p>其實一開始我們安裝 jupyter notebook 時，就是安裝額外 Package了</p>
<p>這邊我們要裝一個，我目前認為最難安裝起來的 Package了</p>
<p>沒錯，就是 <b> <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code> </b></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">psycopg2</span></code> 是python 連線到 postgresSQL 的Package</p>
<p>可以先參考一下 <a class="reference external" href="https://www.psycopg.org/docs/">psycopg2官網</a></p>
<p>在安裝這個套件前，有一些前置安裝必須完成</p>
</div>
<p>先來下安裝指令吧</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">psycopg2</span>
</pre></div>
</div>
<p>或</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">install</span> <span class="n">psycopg2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>使用本機的人，可以試試看</p>
<p>如果是用我們的 Notebook Server 可以先不用</p>
<p>會有權限讓你無法安裝 （雖然可以用 <code class="docutils literal notranslate"><span class="pre">--user</span></code> 來 pass error）</p>
<p><s>也可以先看看這個錯誤到底是什麼</s></p>
<p>等等我會一次安裝給 Notebook Server 的人來用</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">MacOS通常遇到的問題</p>
<p>如果是 Windows 應該不太有問題</p>
<p>如果是 MacOS(UNIX Like) 的才會遇到以下兩種</p>
<ol class="simple">
<li><p>pg_config Problem</p></li>
<li><p>openssl Problem (MacOS)</p></li>
</ol>
<p>第一點比較好解決，只需要安裝 PostgreSQL 或 libpq-dev 就好</p>
<p>MacOS 建議裝 PostgreSQL 會比較沒問題 <s> 我沒試過只裝 libpq </s></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">postgresql</span><span class="o">@</span><span class="mf">9.6</span>
</pre></div>
</div>
<p>會安裝 9.6 PostgreSQL</p>
<p>第二點比較麻煩一點，錯誤訊息比較難辨認，大概會有這種訊息出現</p>
<p><img alt="img" src="../_images/postgres.png" /></p>
<p>這個時候，請安裝 OpenSSL</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">openssl</span>
</pre></div>
</div>
<p>安裝完的畫面如下</p>
<p><img alt="img" src="../_images/openssl.png" /></p>
<p>如圖中所示，將兩個環境變數加到 <code class="docutils literal notranslate"><span class="pre">.bash_profile</span></code> 或 <code class="docutils literal notranslate"><span class="pre">.zshrc</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">LDFLAGS</span><span class="o">=</span><span class="s2">&quot;-L/usr/local/opt/openssl@1.1/lib&quot;</span>
<span class="n">export</span> <span class="n">CPPFLAGS</span><span class="o">=</span><span class="s2">&quot;-I/usr/local/opt/openssl@1.1/include&quot;</span>
</pre></div>
</div>
<p>再重新安裝 psycopg2 應該就沒問題了</p>
</div>
<div class="section" id="id1">
<h3>安裝後測試<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>有兩個方法可以確認是否安裝完成</p>
<ul class="simple">
<li><p>第一種： 確認 pip Package</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip3</span> <span class="n">show</span> <span class="n">psycopg2</span>
</pre></div>
</div>
<p>這種方法確認  「 pip 有正確安裝 」</p>
<ul class="simple">
<li><p>第二種： 確認 import</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import psycopg2&#39;</span>
</pre></div>
</div>
<p>這種方法確認 「 安裝後能夠正確運行 」</p>
<p>有時候雖然正確安裝，但無法正確執行</p>
<p>通常會是環境問題 e.g. MacOS OpenSSL 新舊版本差異造成的錯誤</p>
<p>我通常都用第二種</p>
</div>
</div>
<div class="section" id="psycopg2">
<h2>psycopg2 基礎使用<a class="headerlink" href="#psycopg2" title="Permalink to this headline">¶</a></h2>
<p>不多說，實際連線到我們的 Trinity Repository 裡面瞧瞧</p>
<div class="admonition-trinity-server-info admonition">
<p class="admonition-title">Trinity Server INFO</p>
<p>Host = 10.140.0.2</p>
<p>Port = 5432</p>
<p>DB Name = trinity</p>
<p>User Name = trinity</p>
<p>Password = trinity</p>
</div>
<div class="cell tag_hide-output tag_show-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psycopg2</span>

<span class="c1"># 連線 94 這麼簡單</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;10.140.0.2&#39;</span><span class="p">,</span> <span class="n">dbname</span><span class="o">=</span><span class="s1">&#39;trinity&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;trinity&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;trinity&#39;</span><span class="p">)</span>

<span class="c1"># Create Cursor</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># 三個單引號 --&gt; String </span>
<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select b2.busentityname, j2.categoryname, j.jobname</span>
<span class="s2">from job j</span>
<span class="s2">left join jobcategory j2 on j.categoryuid = j2.categoryuid</span>
<span class="s2">left join busentitycategory b on j.categoryuid = b.categoryuid</span>
<span class="s2">left join busentity b2 on b.busentityuid = b2.busentityuid</span>
<span class="s2">where j.activate = &#39;1&#39;</span>
<span class="s2">  and b2.busentityname = &#39;Z_COSMED&#39;</span>
<span class="s2">  and j2.categoryname = &#39;EXT&#39;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># 執行 SQL</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>

<span class="c1"># cursor object is iterable</span>
<span class="k">for</span> <span class="n">rs</span> <span class="ow">in</span> <span class="n">cursor</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_FINTARGETTEAM&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STOCKSALES_DATETYPE&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STOREHOURSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_TAXREFUND&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_TANAITEMSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_TANADETAILSALES_MON&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_TANADETAILSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STORESALESTARGET_MONTH&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STORESALESTARGET&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STOREITEMSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_KEYITEMEVENTDETAIL&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STOREGROUPSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STOREDAY&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STOCKSTOREITEM_MON&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STOCKSALES_14D&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_STOCKITEMSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_PROMOITEMSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_PAYMENTSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_PAYMENTPROMOSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_KEYITEMEVENTTARGET&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_DEPTSALESTARGET&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_ITEMSALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_INVOICESALES&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_INVOICEDETAILSALES_TODAY&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_INVOICEDETAILSALES_FAST&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_INCOMESTATEMENT_A&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_INCOMESTATEMENT&#39;)
(&#39;Z_COSMED&#39;, &#39;EXT&#39;, &#39;EXT_GROUPSALESTARGET&#39;)
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">cursor 有些小知識</p>
<div class="admonition-from-psycopg2-doc admonition">
<p class="admonition-title">from Psycopg2 Doc</p>
<p>When a database query is executed, the Psycopg cursor usually fetches all the records returned by the backend, transferring them to the client process. If the query returned an huge amount of data, a proportionally large amount of memory will be allocated by the client.</p>
</div>
<p>根據 psycopg2 文件中所述</p>
<p>cursor 執行 SQL 後， 所有 result data 會被傳輸至 Client 端</p>
<p>所以會吃 <strong>記憶體</strong></p>
<p>這其實有點危險</p>
<p>比如我們的 NoteBook Server 大家 Share 同一台 Server Machine Resource</p>
<p>這時候如果用這個，容易佔據大量資源</p>
<p>這時候， Server-Side Cursor 就可以解決這個問題</p>
<p>透過控制每次 fetch 的數量，預設上是每次遞迴約 2000 筆</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Server-side Cursor</span>
<span class="n">server_cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="s1">&#39;Jupyter&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>可以看到每一筆資料的長相</p>
<p>大概是這樣 每一筆</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BUSENTITY_NAME</span>  <span class="n">CATEGORY_NAME</span>  <span class="n">JOB_NAME</span>

<span class="n">Z_COSMED</span>        <span class="n">EXT</span>            <span class="n">JOBNAME</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>可以發現，回傳的資料每筆都是  <code class="docutils literal notranslate"><span class="pre">Tuple</span></code>  型態</p>
<p>所以剛才的 rs，就可以像 List 一樣使用 Index 來找指定元素</p>
</div>
<div class="cell tag_hide-output tag_show-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 重新執行 SQL</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>

<span class="c1"># cursor object is iterable</span>
<span class="k">for</span> <span class="n">rs</span> <span class="ow">in</span> <span class="n">cursor</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Business Entity : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Category Name : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Job Name : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==================&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_FINTARGETTEAM
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STOCKSALES_DATETYPE
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STOREHOURSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_TAXREFUND
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_TANAITEMSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_TANADETAILSALES_MON
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_TANADETAILSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STORESALESTARGET_MONTH
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STORESALESTARGET
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STOREITEMSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_KEYITEMEVENTDETAIL
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STOREGROUPSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STOREDAY
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STOCKSTOREITEM_MON
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STOCKSALES_14D
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_STOCKITEMSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_PROMOITEMSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_PAYMENTSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_PAYMENTPROMOSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_KEYITEMEVENTTARGET
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_DEPTSALESTARGET
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_ITEMSALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_INVOICESALES
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_INVOICEDETAILSALES_TODAY
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_INVOICEDETAILSALES_FAST
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_INCOMESTATEMENT_A
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_INCOMESTATEMENT
==================
Business Entity : Z_COSMED
Category Name : EXT
Job Name : EXT_GROUPSALESTARGET
==================
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./PartI"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Basic3.html" title="previous page">Python 的基礎 - 檔案操作</a>
    <a class='right-next' id="next-link" href="Basic4-5.html" title="next page">Python 的基礎 - Package 的使用與安裝 2</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By PS-VincentHsu<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>